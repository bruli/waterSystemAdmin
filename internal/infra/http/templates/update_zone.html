{% extends "layouts/base.html" %}
{% block content %}
<div class="container">
    <h2 class="text-center my-4">Update Zone</h2>
    {% include "partials/success_form.html" %}
    {% include "partials/error_form.html" %}

    <div class="d-flex justify-content-center">
        <form method="POST" action="/zones/{{ zone.ID }}/edit" class="p-4 border rounded shadow-sm w-100" style="max-width: 600px;">
            <div class="mb-3">
                <label for="name" class="form-label">Name</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ zone.Name }}" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Relays</label>
                <div class="row">
                    {% for i in relays %}
                    <div class="col-6 col-sm-4 col-md-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="relays" id="relay{{ i }}" value="{{ i }}"
                                   {% if i in zone.Relays %}checked{% endif %}>
                            <label class="form-check-label" for="relay{{ i }}">Relay {{ i }}</label>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">Update Zone</button>
            </div>
        </form>
    </div>
</div>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("zoneForm");
        const checkboxes = document.querySelectorAll('input[name="relays"]');

        form.addEventListener("submit", function (e) {
            const anyChecked = Array.from(checkboxes).some(cb => cb.checked);
            if (!anyChecked) {
                e.preventDefault();
                alert("Cal seleccionar almenys un relay.");
            }
        });
    });
</script>

{% endblock %}